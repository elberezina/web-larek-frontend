# Проектная работа "Веб-ларек"


Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Основные типы данных

```
interface IAppState - Интерфейс описывающий состояние приложения
	catalog: IProduct[] - каталог товаров
	basket: IProduct[] - корзина
	order: IOrder | null - заказ
	setCatalog(items: IProduct[]): void - устанавливаем каталог товаров 
	addToBasket(product: IProduct): void - добавляем товар в корзину
	removeFromBasket(product: IProduct): void - удаляем товар из корзины

interface IModal - интерфейс описывающий содержимое модельного окна
	content: HTMLElement - DOM-элемент модального окна

interface IProduct  - интерфейс описывающий поля карточки товара
	id: string - идентификатор товара в магазине
	image: string - URL адрес картинки товара
	title: string - название товара
	category: string - категория товара
	price: number - цена товара
	description: string - описание товара

interface IPage - интерфейс описывающий страницу
	counter: number - счетчик товаров в корзине
	catalog: HTMLElement[] - массив карточек с товарами
	locked: boolean - блокировка прокрутки страницы

 interface IBasket - интерфейс описывающий корзину товаров
	list: HTMLElement[] - массив строк с товарами
	total: number - общая стоимость товаров

 interface IProductInBasket extends IProduct - Интерфейс описывает товар в списке корзины
	index: number - порядковый номер в корзине

interface IOrder - интерфейс описывающий информацию о заказе
	items: string[] - массив идентификаторов купленных товаров
	payment: string - способ оплаты
	total: number - сумма заказа
	address: string - адрес доставки
	email: string - Email
	phone: string - номер телефона

interface IContactsForm - Интерфейс описывает окно ввода контактных данных
	phone: string - телефон
	email: string - Email

interface IPaymentForm - Интерфейс описывающий форму оплаты
	address: string - адрес
	payment: string - способ оплаты

interface IOrderResult - Интерфейс описывающий ответ успешной покупки
	id: string - идентификатор заказа
	total: number - сумма заказа
```

## Базовый код

```
class Api
Это базовый класс,  который отвечает за работу с сервером. 
Конструктор класса:
	baseUrl: string - принимает базовый Url для доступа к серверу
	options: RequestInit - опции для доступа к различным параметрам

Реализует методы:
	get(uri: string) - для получения данных с сервера
	post(uri: string, data: object, method: ApiPostMethods = 'POST') - для отправки данных на сервер
	handleResponse(response: Response): Promise<object> - обрабатывает ответ от сервера

class EventEmitter
Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события. Имеет конструктор который инициализирует события и реализует следующие методы:
	on  - установить обработчик на событие
	off - снять обработчик с события
	emit - инициировать событие с данными
	onAll - слушать все события
	offAll - сбросить все обработчики
	trigger - создает коллбек триггер, генерирующий событие при вызов

abstract class Component<T> 
Это базовый абстрактный класс,  который является основой для компонентов проекта. 
Конструктор класса:
	constructor(protected readonly container: HTMLElement) - принимает DOM элемент для работы в дочерних компонентах

Реализует следующие методы:
	toggleClass(element: HTMLElement, className: string, force?: boolean) - используем для переключения класса компонента
	protected setText(element: HTMLElement, value: unknown) - устанавливает текстовое содержимое
	setDisabled(element: HTMLElement, state: boolean) - определяет нужна блокировка или нет
	setHidden(element: HTMLElement) - скрывает элемент
	setVisible(element: HTMLElement) - показывает элемент удаляя свойство display = 'none'
	setImage(element: HTMLImageElement, src: string, alt?: string) - устанавливает изображение с альтернативным текстом. 
	render(data?: Partial<T>): HTMLElement - возвращает корневой  DOM-элемент.

abstract class Model<T>
Это абстрактный класс, базовая модель, чтобы можно было отличить ее от простых объектов с данными. 
Конструктор:
	constructor(data: Partial<T>, protected events: IEvents) - принимает данные и событие

Реализует метод:
	emitChanges(event: string, payload?: object) - сообщает всем что модель поменялась
```



## Компоненты модели данных

```class LarekAPI 
Класс наследуется от базового класса Api, позволяет получить список карточек с сервера и необходимую информацию по каждой карточке для дальнейшего использования в галлерее и в оформлении заказа. 
Имеет методы:
	getProductById - получить продукт по ID
	getProductList- получить список продуктов

class AppState 
Класс наследуется от базового класса Model и расширяется интерфейсом IAppState.  Данный класс хранит состояние приложения.
Класс принимает следующую информацию:
	basket: Product[] - список товаров в корзине
	catalog: Product[] - каталог товаров
	order: IOrder - заказ

Методы класса:
	setCatalog(items: IProduct[]) - устанавливает каталог продуктов
	addToBasket(product: Product) - добавляет продукт в корзину 
	removeFromBasket(product: Product) - удаляет продукт из корзины
```

## Компоненты представления

```
class Page 
Класс для отображения главной страницы. Наследуется от базового класса Component и расширяется интерфейсом IPage. 
Класс загружает каталог товаров на главную страницу, учитывает количество товаров в корзине и отражает информацию на иконке корзины. При открытии модального окна, страница блокируется. 
Класс принимает информацию:
	counter: HTMLElement - DOM элемент счетчика товаров в корзине
	catalog: HTMLElement - DOM элемент каталога товаров
	wrapper: HTMLElement - DOM элемент главной страницы
	basket: HTMLElement - DOM элемент корзины

Конструктор класса: 
	container: HTMLElement - DOM элемент всей страницы
	events: IEvents - ссылка на объект, который имплиментирует интерфейс IEvents, в нашем случае это объект класса EventEmmiter, для того чтобы компонент мог создавать события и подписываться 			на них. Например, чтобы обновлять данные на главной странице.

Методы класса:
	set counter(value: number) - устанавливает счетчик на иконке корзины
	set catalog(items: HTMLElement[]) - устанавливает каталог товаров
	set locked(value: boolean) - при открытие модального окна страница блокируется


class Card
Класс описывает компоненту карточки товара, наследуется от базового класса Component и расширяется интерфейсом IProduct. Данные класс служит для отображения карточки и информации по ней в галлереи товаров, просмотре карточки товара и корзине. Класс принимает необходимую для заполнения карточки информацию:
	image: HTMLImageElement DOM элемент изображения продукта
	title: HTMLElement DOM элемент названия продукта
	category: HTMLElement; DOM элемент категории продукта
	price: HTMLElement; DOM элемент цены продукта
	description: HTMLElement; DOM элемент описание продукта
	button?: HTMLButtonElement; DOM элемент кнопки продукта

Конструктор класса принимает: 
blockName - имя блока 
HTMLElement - DOM элемент карточки товара 
ICardActions - действия с карточкой

Методы класса:
	set id - устанавливает  Id товара
	set Image - устанавливает картинку товара
	set title - устанавливает название товара
	set category - устанавливает категорию товара
	set price -  устанавливает цену товара
	set description -  устанавливает описание товара
	set button - устанавливает название кнопки


class CardItemPreview 
Класс наследуется от класса Card. Класс описывает карточку товара при открытии в модальном окне. Класс принимает 
	description: HTMLElement - DOM элемент описания карточки товара.

Конструктор класса
	container: HTMLElement -  DOM элемент карточки товара 
	actions?: ICardActions - действия с карточкой

Метод класса:
	set description(value: string) - устанавливает описание товара


class Basket 
Класс наследуется от базового класса Component и расширяется интерфейсом IBasket. Отвечает за работу с корзиной, отражает информацию по товарам в корзине, стоимости каждой единицы товара, дает возможность удалить товар из корзины, считает и показывает общую сумму заказа. 
Класс принимает информацию:
	list: HTMLElement - список товаров в корзине
	total: HTMLElement - общая стоимость товаров в корзине
	button: HTMLButtonElement - кнопка корзины оформления заказа

Конструктор класса принимает: 
	blockName - имя блока
	container: DOM элемент компонента корзины
	events - ссылка на объект, который имплиментирует интерфейс IEvents, в нашем случае это объект класса EventEmmiter, для того чтобы компонент мог создавать события и подписываться на них. 			Например, для удаления товара из корзины и запуска процесса оформления заказа

Методы класса:
	set total(price: number) - отражает итоговую стоимость товаров в корзине
	set list(items: HTMLElement) - отражает содержимое корзины


class PaymentForm 
Класс наследуется от базового класса Form и расширяется интерфейсом IPaymentForm. Класс описывает форму оплаты товара при оформлении заказа.
Класс принимает информацию:
	card: HTMLButtonElement - оплата заказа картой
	onReceipt: HTMLButtonElement -  оплата заказа при получении

Конструктор класса принимает: 
	blockName: string - имя блока
	container: DOM - элемент формы оплаты
	events - ссылка на объект, который имплиментирует интерфейс IEvents, в нашем случае это объект класса EventEmmiter, для того чтобы компонент мог создавать события и подписываться на них. 			Например, для чтобы обновлять данные модели, где храниться информация о способе платежа или для взаимодействия с другими компонентами.
 

class ContactsForm 
Класс наследуется от базового класса Form и расширяется интерфейсом IContactsForm. Класс описывает форму ввода контактных данных.
Класс принимает информацию:
	container: HTMLFormElement - компонент формы
	events -  ссылка на объект, который имплиментирует интерфейс IEvents, в нашем случае это объект класса EventEmmiter, для того чтобы компонент мог создавать события и подписываться на них. 			Например, для чтобы обновлять данные модели, где храниться информация о контактных данных по заказу.
```


